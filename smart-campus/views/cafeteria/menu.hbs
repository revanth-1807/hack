<div style="display: flex; justify-content: between; align-items: center; margin-bottom: 2rem;">
    <h1>Cafeteria Menu</h1>
    <div>
        <a href="/cafeteria" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
        {{#if (eq user.role 'admin')}}
        <a href="/admin/cafe/menu/create" class="btn btn-primary">
            <i class="fas fa-plus"></i> Add Menu Item
        </a>
        {{/if}}
    </div>
</div>

<!-- Category Filter -->
<div class="card" style="margin-bottom: 2rem;">
    <h3>Filter by Category</h3>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="/cafeteria/menu" class="btn btn-outline-primary {{#unless category}}active{{/unless}}">
            All Items
        </a>
        {{#each categories}}
        <a href="/cafeteria/menu?category={{this}}" class="btn btn-outline-primary {{#if (eq this ../category)}}active{{/if}}">
            {{this}}
        </a>
        {{/each}}
    </div>
</div>

{{#if items.length}}
<div class="row">
    {{#each items}}
    <div class="card" style="width: 280px;">
        {{#if image}}
        <img src="/uploads/{{image}}" alt="{{name}}" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px 8px 0 0;">
        {{else}}
        <div style="height: 180px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; border-radius: 8px 8px 0 0;">
            <i class="fas fa-utensils" style="font-size: 3rem; color: #999;"></i>
        </div>
        {{/if}}
        
        <div style="padding: 1rem;">
            <h3>{{name}}</h3>
            <p style="color: #666; margin-bottom: 0.5rem;">{{description}}</p>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <span style="color: #28a745; font-weight: bold; font-size: 1.2rem;">â‚¹{{price}}</span>
                <span class="badge badge-primary">{{category}}</span>
            </div>

            {{#if isAvailable}}
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span class="badge badge-success">Available</span>
                <form action="/cafeteria/order" method="POST" style="display: inline;">
                    <input type="hidden" name="menuItemId" value="{{_id}}">
                    <input type="hidden" name="quantity" value="1">
                    <button type="submit" class="btn btn-primary btn-sm">
                        <i class="fas fa-cart-plus"></i> Order Now
                    </button>
                </form>
            </div>
            {{else}}
            <div class="badge badge-secondary">Out of Stock</div>
            {{/if}}

            <div style="margin-top: 1rem;">
                <a href="/cafeteria/menu/{{_id}}" class="btn btn-outline-primary btn-sm btn-block">
                    View Details
                </a>
            </div>
        </div>
    </div>
    {{/each}}
</div>
{{else}}
<div class="card" style="text-align: center; padding: 3rem;">
    <i class="fas fa-utensils" style="font-size: 4rem; color: #6c757d; margin-bottom: 1rem;"></i>
    <h3>No Menu Items Available</h3>
    <p>No menu items found for the selected category.</p>
    <a href="/cafeteria/menu" class="btn btn-primary">View All Items</a>
</div>
{{/if}}

{{#if (eq user.role 'admin')}}
<div style="margin-top: 2rem;">
    <a href="/admin/cafe" class="btn btn-warning">
        <i class="fas fa-cog"></i> Manage Menu (Admin)
    </a>
</div>
{{/if}}
